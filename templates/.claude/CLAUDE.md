# Claude Code カスタム指示

## 言語設定

**日本語を基本言語として使用してください。**

- すべての応答は日本語で行う
- コメントは日本語で記述
- ドキュメントは日本語で作成
- エラーメッセージの説明は日本語で
- コードそのもの（変数名、関数名など）は英語でも可

## コミュニケーションスタイル

- 丁寧語を使用（「です・ます」調）
- 技術用語は適切に日本語訳するか、英語のままカタカナ表記
- 不明点は必ず質問する
- 段階的に説明し、理解を確認しながら進める

## 作業原則

### 変更前の確認
- コードを変更する前に、必ず既存の実装を読んで理解する
- 影響範囲を事前に提示し、承認を得てから作業する
- 既存のコードパターン・規約を尊重し、一貫性を保つ

### 安全な作業
- 破壊的変更を行う前に必ず確認する
- 一度に大きな変更をせず、小さなステップで進める
- 変更後は関連するテストを実行して動作確認する

### 情報の正確性
- 不確かな情報は推測であることを明示する
- ライブラリのバージョンやAPIの仕様は最新ドキュメントで確認する
- エラーの原因が不明な場合は、複数の可能性を提示する

## コード品質基準

以下はプロジェクトの技術スタックに応じて適用してください。

### 共通原則
- マジックナンバーは定数化する
- 関数は単一責任の原則に従う（1関数1目的）
- 早期リターンで条件分岐のネストを浅く保つ
- 命名で意図を表現する（コメントに頼らない）
- 関数は30行以内を目安（超える場合は分割を検討）
- パラメータは3個以内（超える場合はオブジェクトにまとめる）

### TypeScript / JavaScript（該当プロジェクトの場合）
- `any` 型の使用を禁止（`unknown` + 型ガードを使用）
- `null` より `undefined` を優先（API境界を除く）
- `const` を優先、`let` は必要な場合のみ、`var` は禁止

※ 詳細な命名規則・言語固有の規約は `rules/coding-style.md` を参照
※ セキュリティ規約は `rules/security.md` を参照

## テスト方針

- AAA パターン（Arrange / Act / Assert）で記述
- 振る舞いベース: 内部実装ではなくユーザーの振る舞いをテスト
- カバレッジ目標: 新規コードは80%以上

※ 詳細な規約は `rules/testing.md` を参照

## Git ワークフロー

- Conventional Commits に準拠（`feat` / `fix` / `docs` / `refactor` / `test` / `chore` 等）
- ブランチ命名: `feature/<機能名>` / `fix/<バグ名>` / `refactor/<対象>`

※ 詳細な規約は `rules/git-workflow.md` を参照

## MCP ツール活用指針

### serena（シンボリック操作）
- コードの構造理解には `get_symbols_overview` → `find_symbol` の順で使用
- シンボル単位の編集には `replace_symbol_body` を優先
- 参照の追跡には `find_referencing_symbols` を使用

### context7（ドキュメント参照）
- ライブラリの使い方が不明な場合に `resolve-library-id` → `query-docs` で確認
- 公式ドキュメントの最新情報を取得

### filesystem（ファイル操作）
- 非コードファイル（設定、ドキュメント等）の読み書きに使用
- ディレクトリ構造の確認に使用

## コーディング規約

- コメント：日本語
- docstring：日本語
- commit message：日本語と英語の併記（英語タイトル、日本語詳細）
- README/ドキュメント：日本語

## 例

### 良い例

```
// 定数は名前付きで定義
MAX_RETRY_COUNT = 3

// 関数は単一責任で、日本語コメントを付与
function calculateTotalPrice(items):
    // 各商品の価格を合計
    return sum(item.price for item in items)
```

※ 実際のコードは、プロジェクトの言語・フレームワークに合わせて記述してください。

### コミットメッセージの例

```
feat: ユーザー認証機能を追加

- メールアドレスとパスワードによるログイン機能
- JWTトークンベースの認証
- パスワードのハッシュ化（bcrypt使用）
```
