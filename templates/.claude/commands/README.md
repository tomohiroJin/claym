# Claude Code カスタムコマンド

このディレクトリには、Claude Code で使用できるカスタムコマンドのテンプレートが含まれています。

## 概要

カスタムコマンドは、特定のタスクを効率化するためのプロンプトテンプレートです。Markdown ファイルとして定義され、Claude Code の CLI で `/command-name` として呼び出すことができます。

## 提供されるコマンド

### `/code-gen` - コード生成

特定のパターンやテンプレートに基づいてコードを自動生成します。

**ユースケース**:
- CRUD 操作の自動生成
- API エンドポイントの自動生成
- データモデル・スキーマの自動生成

**使用例**:
```bash
/code-gen User モデルの CRUD API を作成してください
```

**詳細**: [code-gen.md](./code-gen.md)

---

### `/review` - コードレビュー

コードの品質チェックとレビューを実施します。

**ユースケース**:
- セキュリティの脆弱性チェック
- パフォーマンスレビュー
- コーディング規約の遵守確認

**使用例**:
```bash
/review 現在のブランチの変更をレビュー
```

**詳細**: [review.md](./review.md)

---

### `/docs` - ドキュメント生成

README や API ドキュメントなどを自動生成します。

**ユースケース**:
- README.md の自動生成
- API ドキュメントの生成
- JSDoc/docstring の生成

**使用例**:
```bash
/docs プロジェクトの README.md を作成
```

**詳細**: [docs.md](./docs.md)

---

### `/test` - テスト関連

テストケースの生成とテスト実行を支援します。

**ユースケース**:
- ユニットテストの自動生成
- 統合テストの自動生成
- テストカバレッジの分析

**使用例**:
```bash
/test src/utils/validator.ts のユニットテストを作成
```

**詳細**: [test.md](./test.md)

---

## カスタマイズ方法

### 1. 既存コマンドの編集

既存のコマンドをプロジェクトに合わせてカスタマイズできます：

```bash
# コマンドファイルを編集
vim .claude/commands/code-gen.md
```

**編集例**:
```markdown
## デフォルト設定

- 言語: TypeScript
- フレームワーク: Express.js
- ORM: Prisma
- テストフレームワーク: Jest
```

### 2. 新規コマンドの追加

新しいコマンドを追加する手順：

#### Step 1: コマンドファイルを作成

```bash
touch .claude/commands/my-command.md
```

#### Step 2: コマンドの内容を記述

```markdown
# マイカスタムコマンド

このコマンドは〇〇を行います。

## 使い方

`/my-command <引数>`

## プロンプト

以下のガイドラインに従って処理してください：

1. まず△△を確認
2. 次に□□を実行
3. 結果を××形式で出力
```

#### Step 3: Claude Code を再起動

```bash
# VSCode で Claude Code を再起動
# または Claude Code CLI を再起動
```

#### Step 4: コマンドを実行

```bash
/my-command 引数1 引数2
```

### 3. コマンドの削除

不要なコマンドは削除できます：

```bash
rm .claude/commands/test.md
```

## コマンドファイルの構造

カスタムコマンドは以下の構造で記述することを推奨します：

```markdown
# コマンドのタイトル

コマンドの簡潔な説明

## 概要

コマンドの詳細な説明、目的、ユースケース

## 使い方

\`\`\`
/command-name <引数の説明>
\`\`\`

### 例

具体的な使用例を複数提示

## プロンプト

Claude に渡される実際のプロンプト内容

### 1. ステップ1の説明
### 2. ステップ2の説明
...

## 例: 具体的なケース

ユーザーの入力例と期待される出力例

## カスタマイズ

このコマンドをカスタマイズする方法

## 注意事項

使用時の注意点

## トラブルシューティング

よくある問題と解決策
```

## ベストプラクティス

### コマンド設計の原則

1. **単一責任**: 1つのコマンドは1つの目的に特化
2. **明確性**: コマンド名は目的が明確にわかるもの
3. **再利用性**: プロジェクト間で再利用できる汎用的な設計
4. **拡張性**: プロジェクト固有の要件に対応できる柔軟性

### プロンプト記述のコツ

1. **具体的な指示**: 曖昧な表現を避け、具体的に記述
2. **段階的な手順**: ステップバイステップで処理を指示
3. **例示**: 期待される出力の例を含める
4. **エラーハンドリング**: 異常系の処理も明示

### メンテナンス

1. **定期的な見直し**: プロジェクトの変化に合わせて更新
2. **バージョン管理**: 大きな変更は git で管理
3. **ドキュメント化**: カスタマイズ内容をコメントで記録

## コマンドのバージョン管理

### テンプレートとの同期

テンプレートから最新のコマンドを取得：

```bash
# 再設定スクリプトで一括更新
bash scripts/setup/reinit-ai-configs.sh

# または個別にコピー
cp templates/.claude/commands/code-gen.md .claude/commands/
```

### カスタマイズの保持

カスタマイズした内容を保持しつつ更新する場合：

1. **バックアップを作成**
   ```bash
   bash scripts/setup/reinit-ai-configs.sh --backup-only
   ```

2. **テンプレートの変更を確認**
   ```bash
   diff .claude/commands/code-gen.md templates/.claude/commands/code-gen.md
   ```

3. **必要な変更のみを適用**
   ```bash
   # 手動でマージするか、パッチを適用
   ```

## 高度な使い方

### 複数コマンドの組み合わせ

複数のコマンドを組み合わせて使用：

```bash
# コードを生成
/code-gen User API を作成

# 生成されたコードをレビュー
/review src/api/users.ts

# ドキュメントを生成
/docs src/api/users.ts の API ドキュメントを作成

# テストを生成
/test src/api/users.ts のテストを作成
```

### プロジェクト固有のワークフロー

プロジェクト固有のワークフローをコマンド化：

```markdown
# feature-flow.md

# 新機能追加ワークフロー

このコマンドは新機能追加の標準フローを実行します。

## プロンプト

以下の手順で新機能を追加してください：

1. 機能の要件を確認
2. 設計ドキュメントを作成
3. コードを生成
4. テストを作成
5. ドキュメントを更新
6. レビューチェックリストを作成
```

### 条件分岐を含むコマンド

コンテキストに応じて処理を変えるコマンド：

```markdown
## プロンプト

まず、プロジェクトの構成を確認してください：

- TypeScript プロジェクトの場合: Jest を使用
- Python プロジェクトの場合: pytest を使用
- 他の言語の場合: 適切なテストフレームワークを選択

次に、選択したフレームワークに応じたテストを生成してください。
```

## トラブルシューティング

### コマンドが認識されない

**原因**: ファイル名や配置が不適切

**解決方法**:
1. ファイルが `.claude/commands/` ディレクトリにあることを確認
2. ファイル名が `<command-name>.md` であることを確認
3. Claude Code を再起動

### コマンドが期待通りに動作しない

**原因**: プロンプトが不明確

**解決方法**:
1. プロンプトをより具体的に記述
2. 期待される出力の例を追加
3. ステップバイステップの指示を追加

### コマンドの実行が遅い

**原因**: プロンプトが複雑すぎる

**解決方法**:
1. コマンドを小さく分割
2. 不要な処理を削除
3. キャッシュを活用できる設計に変更

## 関連ドキュメント

- [Claude Code 公式ドキュメント](https://docs.claude.com/en/docs/claude-code)
- [spec.md](../../../docs/claude-code-extensible-config-spec.md) - 設計仕様書
- [todo.md](../../../docs/claude-code-extensible-config-todo.md) - タスクリスト
- [templates/README.md](../../README.md) - テンプレート全体の説明

## サンプルコマンド集

### データベースマイグレーション

```markdown
# db-migrate.md

## プロンプト

データベースマイグレーションファイルを生成してください：

1. 既存のマイグレーションを確認
2. 新しいマイグレーションファイルを作成
3. up/down メソッドを実装
4. マイグレーション実行手順を提示
```

### API クライアント生成

```markdown
# api-client.md

## プロンプト

API クライアントコードを生成してください：

1. OpenAPI スキーマを確認
2. TypeScript の型定義を生成
3. API メソッドを生成
4. エラーハンドリングを含める
```

## コントリビューション

コマンドの改善案やバグ報告は、Issue または Pull Request でお願いします。

### 良いコマンドの条件

- [ ] 明確な目的がある
- [ ] 再利用可能である
- [ ] ドキュメントが充実している
- [ ] エッジケースを考慮している
- [ ] 他のコマンドと整合性がある

---

**更新日**: 2025-10-20
