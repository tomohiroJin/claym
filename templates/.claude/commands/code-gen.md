# コード生成コマンド

このコマンドは、特定のパターンやテンプレートに基づいてコードを自動生成します。

## 概要

`/code-gen` コマンドは、繰り返しの多いコード記述作業を効率化するために設計されています。以下のような場面で活用できます：

- CRUD 操作の自動生成
- API エンドポイントの自動生成
- データモデル・スキーマの自動生成
- ボイラープレートコードの生成

## 使い方

```
/code-gen <生成したいコードの説明>
```

### 例

```
/code-gen User モデルの CRUD API を作成してください
```

```
/code-gen PostgreSQL スキーマから TypeScript の型定義を生成
```

```
/code-gen RESTful API のルーターとコントローラーを生成
```

## プロンプト

以下のガイドラインに従ってコードを生成してください：

### 1. プロジェクト構造の理解

まず、プロジェクトの構造とコーディング規約を確認してください：

- 既存のファイル構造を確認
- 使用されているフレームワーク・ライブラリを特定
- コーディングスタイルを分析（命名規則、インデント、etc.）

### 2. コード生成の原則

#### 一貫性

- **命名規則**: プロジェクト既存のパターンを踏襲
- **ディレクトリ構造**: 既存の構造に従って配置
- **インポートスタイル**: 既存のインポート方法を使用

#### 品質

- **型安全性**: TypeScript/Python の型ヒントを適切に使用
- **エラーハンドリング**: 適切なエラーハンドリングを実装
- **バリデーション**: 入力値の検証を含める
- **ドキュメント**: 日本語コメント・docstring を追加

#### セキュリティ

- **入力検証**: すべての外部入力を検証
- **SQL インジェクション対策**: パラメータ化クエリを使用
- **認証・認可**: 必要に応じて認証チェックを含める

### 3. 生成するコードの範囲

以下を含むコードを生成してください：

1. **メインロジック**
   - 機能の中核となるコード
   - 適切な抽象化レベル

2. **テストコード**（必要に応じて）
   - ユニットテストのテンプレート
   - 基本的なテストケース

3. **ドキュメント**
   - コードコメント（日本語）
   - 使用例
   - 注意事項

### 4. 生成後の説明

コード生成後、以下を説明してください：

- **生成したファイルの一覧**
- **各ファイルの役割**
- **次のステップ**（設定、依存関係のインストールなど）
- **カスタマイズポイント**

## 例: CRUD API の生成

### ユーザーの入力

```
/code-gen Task モデルの CRUD API を Express で作成
```

### 期待される出力

1. **モデルファイル** (`models/task.ts`)
   - Task モデルの定義
   - バリデーションルール

2. **コントローラー** (`controllers/taskController.ts`)
   - CREATE: タスク作成
   - READ: タスク一覧取得、単一取得
   - UPDATE: タスク更新
   - DELETE: タスク削除

3. **ルーター** (`routes/tasks.ts`)
   - エンドポイント定義
   - ミドルウェアの設定

4. **テスト** (`tests/task.test.ts`)
   - 基本的なテストケース

5. **説明**
   - セットアップ手順
   - API の使用例
   - カスタマイズ方法

## カスタマイズ

このコマンドは自由にカスタマイズ可能です：

### パターンの追加

特定のフレームワークやパターンに特化したプロンプトを追加できます：

```markdown
## Django REST Framework の場合

- モデル: models.py
- シリアライザー: serializers.py
- ビュー: views.py
- URL: urls.py
```

### デフォルト設定の変更

プロジェクトのデフォルト設定を定義できます：

```markdown
## デフォルト設定

- 言語: TypeScript
- フレームワーク: Express.js
- ORM: Prisma
- テストフレームワーク: Jest
```

### テンプレートの管理

よく使うテンプレートへの参照を追加できます：

```markdown
## 利用可能なテンプレート

- `/templates/api-endpoint.ts` - API エンドポイントのテンプレート
- `/templates/model.ts` - モデルのテンプレート
```

## 注意事項

### 生成前の確認

- 既存のファイルを上書きしないよう注意
- 依存関係の確認
- データベーススキーマとの整合性

### 生成後の作業

生成されたコードは必ずレビューし、以下を確認してください：

- [ ] ビジネスロジックが要件を満たしている
- [ ] セキュリティ要件を満たしている
- [ ] パフォーマンス上の問題がない
- [ ] テストが適切に動作する

## トラブルシューティング

### コードが生成されない

- プロジェクト構造が複雑すぎる可能性があります
- より具体的な指示を与えてください

### 期待と異なるコードが生成される

- 使用するフレームワーク・ライブラリを明示してください
- 既存のコード例を提示してください

### 生成されたコードが動作しない

- 依存関係のインストールを確認
- 型定義やインポートパスを確認

---

**更新日**: 2025-10-20
