# セキュリティ規約

## 入力検証

### ユーザー入力
- すべてのユーザー入力をバリデーション
- サーバーサイドでの検証は必須（クライアントサイドだけでは不十分）
- ホワイトリスト方式を優先（許可する入力を定義）

### XSS 対策
- ユーザー入力をHTMLに挿入する場合は必ずエスケープ
- 生 HTML のレンダリング API の使用は原則禁止（React: `dangerouslySetInnerHTML`、Vue: `v-html` 等）
- URL パラメータの直接表示禁止

### SQL / NoSQL インジェクション
- パラメータ化クエリまたは ORM を使用
- ユーザー入力をクエリ文字列に直接連結しない

## 機密情報管理

### 環境変数
- API キー、パスワード、トークンは環境変数で管理
- `.env` ファイルは `.gitignore` に含める
- `.env.example` に変数名のみ記載（値は空）

### 禁止事項
- ソースコードへの機密情報のハードコーディング
- ログへの機密情報（パスワード、トークン等）の出力
- コミットメッセージへの機密情報の記載

## データストレージ（Web フロントエンドの場合）

### localStorage / sessionStorage
- 機密情報（トークン、パスワード等）の保存禁止
- ユーザー設定やUI状態の一時保存にのみ使用
- XSS 攻撃で漏洩するリスクを常に考慮

### Cookie
- `HttpOnly` フラグを設定（JavaScript からアクセス不可に）
- `Secure` フラグを設定（HTTPS のみ送信）
- `SameSite` 属性を適切に設定

## 通信

### HTTPS
- 本番環境では HTTPS を必須とする
- HTTP から HTTPS へのリダイレクト設定

### CORS
- `Access-Control-Allow-Origin` にワイルドカード(`*`)を使わない
- 許可するオリジンを明示的にリスト化

### CSRF 対策
- トークンベースの CSRF 対策を実装
- `SameSite` Cookie 属性の活用

## 依存関係

- 定期的に脆弱性をチェック（`npm audit`, `pip-audit`, `cargo audit` 等）
- 重大な脆弱性は速やかにアップデート
- 不要な依存関係は削除
